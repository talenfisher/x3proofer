parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Ofed":[function(require,module,exports) {
var define;
var r;function t(r){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}parcelRequire=function(e,n,s,i){var o,a="function"==typeof parcelRequire&&parcelRequire,h="function"==typeof require&&require;function u(r,t){if(!n[r]){if(!e[r]){var s="function"==typeof parcelRequire&&parcelRequire;if(!t&&s)return s(r,!0);if(a)return a(r,!0);if(h&&"string"==typeof r)return h(r);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}p.resolve=function(t){return e[r][1][t]||t},p.cache={};var o=n[r]=new u.Module(r);e[r][0].call(o.exports,p,o,o.exports,this)}return n[r].exports;function p(r){return u(p.resolve(r))}}u.isParcelRequire=!0,u.Module=function(r){this.id=r,this.bundle=u,this.exports={}},u.modules=e,u.cache=n,u.parent=a,u.register=function(r,t){e[r]=[function(r,e){e.exports=t},{}]};for(var p=0;p<s.length;p++)try{u(s[p])}catch(e){o||(o=e)}if(s.length){var c=u(s[s.length-1]);"object"==("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?module.exports=c:"function"==typeof r&&r.amd?r(function(){return c}):this.X3P=c}if(parcelRequire=u,o)throw o;return u}({gm1b:[function(r,t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(r){return void 0===r&&(r=1),[[0,0],[0,r],[r,0],[r,r],[r,0],[0,r]]}},{}],oQJj:[function(r,t,e){t.exports=function(r){switch(r.toLowerCase()){case"int8":return Int8Array;case"i":case"int16":return Int16Array;case"l":case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"f":case"float32":return Float32Array;case"d":case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],YG3F:[function(r,t,e){"use strict";t.exports=function(r){for(var t=new Array(r),e=0;e<r;++e)t[e]=e;return t}},{}],"q/Zl":[function(r,t,e){function n(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}t.exports=function(r){return null!=r&&(n(r)||function(r){return"function"==typeof r.readFloatLE&&"function"==typeof r.slice&&n(r.slice(0,0))}(r)||!!r._isBuffer)}},{}],cMKA:[function(r,t,e){var n=r("iota-array"),s=r("is-buffer"),i="undefined"!=typeof Float64Array;function o(r,t){return r[0]-t[0]}function a(){var r,t=this.stride,e=new Array(t.length);for(r=0;r<e.length;++r)e[r]=[Math.abs(t[r]),r];e.sort(o);var n=new Array(e.length);for(r=0;r<n.length;++r)n[r]=e[r][1];return n}function h(r,t){var e=["View",t,"d",r].join("");t<0&&(e="View_Nil"+r);var s="generic"===r;if(-1===t){var i="function "+e+"(a){this.data=a;};var proto="+e+".prototype;proto.dtype='"+r+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+e+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+e+"(a){return new "+e+"(a);}";return new Function(i)()}if(0===t)return i="function "+e+"(a,d) {this.data = a;this.offset = d};var proto="+e+".prototype;proto.dtype='"+r+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+e+"_copy() {return new "+e+"(this.data,this.offset)};proto.pick=function "+e+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+e+"_get(){return "+(s?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+e+"_set(v){return "+(s?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+e+"(a,b,c,d){return new "+e+"(a,d)}",new Function("TrivialArray",i)(p[r][0]);i=["'use strict'"];var o=n(t),h=o.map(function(r){return"i"+r}),u="this.offset+"+o.map(function(r){return"this.stride["+r+"]*i"+r}).join("+"),c=o.map(function(r){return"b"+r}).join(","),f=o.map(function(r){return"c"+r}).join(",");i.push("function "+e+"(a,"+c+","+f+",d){this.data=a","this.shape=["+c+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+e+".prototype","proto.dtype='"+r+"'","proto.dimension="+t),i.push("Object.defineProperty(proto,'size',{get:function "+e+"_size(){return "+o.map(function(r){return"this.shape["+r+"]"}).join("*"),"}})"),1===t?i.push("proto.order=[0]"):(i.push("Object.defineProperty(proto,'order',{get:"),t<4?(i.push("function "+e+"_order(){"),2===t?i.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&i.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):i.push("ORDER})")),i.push("proto.set=function "+e+"_set("+h.join(",")+",v){"),s?i.push("return this.data.set("+u+",v)}"):i.push("return this.data["+u+"]=v}"),i.push("proto.get=function "+e+"_get("+h.join(",")+"){"),s?i.push("return this.data.get("+u+")}"):i.push("return this.data["+u+"]}"),i.push("proto.index=function "+e+"_index(",h.join(),"){return "+u+"}"),i.push("proto.hi=function "+e+"_hi("+h.join(",")+"){return new "+e+"(this.data,"+o.map(function(r){return["(typeof i",r,"!=='number'||i",r,"<0)?this.shape[",r,"]:i",r,"|0"].join("")}).join(",")+","+o.map(function(r){return"this.stride["+r+"]"}).join(",")+",this.offset)}");var l=o.map(function(r){return"a"+r+"=this.shape["+r+"]"}),d=o.map(function(r){return"c"+r+"=this.stride["+r+"]"});i.push("proto.lo=function "+e+"_lo("+h.join(",")+"){var b=this.offset,d=0,"+l.join(",")+","+d.join(","));for(var g=0;g<t;++g)i.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}");for(i.push("return new "+e+"(this.data,"+o.map(function(r){return"a"+r}).join(",")+","+o.map(function(r){return"c"+r}).join(",")+",b)}"),i.push("proto.step=function "+e+"_step("+h.join(",")+"){var "+o.map(function(r){return"a"+r+"=this.shape["+r+"]"}).join(",")+","+o.map(function(r){return"b"+r+"=this.stride["+r+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),g=0;g<t;++g)i.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}");i.push("return new "+e+"(this.data,"+o.map(function(r){return"a"+r}).join(",")+","+o.map(function(r){return"b"+r}).join(",")+",c)}");var y=new Array(t),v=new Array(t);for(g=0;g<t;++g)y[g]="a[i"+g+"]",v[g]="b[i"+g+"]";for(i.push("proto.transpose=function "+e+"_transpose("+h+"){"+h.map(function(r,t){return r+"=("+r+"===undefined?"+t+":"+r+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+e+"(this.data,"+y.join(",")+","+v.join(",")+",this.offset)}"),i.push("proto.pick=function "+e+"_pick("+h+"){var a=[],b=[],c=this.offset"),g=0;g<t;++g)i.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");return i.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),i.push("return function construct_"+e+"(data,shape,stride,offset){return new "+e+"(data,"+o.map(function(r){return"shape["+r+"]"}).join(",")+","+o.map(function(r){return"stride["+r+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",i.join("\n"))(p[r],a)}function u(r){if(s(r))return"buffer";if(i)switch(Object.prototype.toString.call(r)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(r)?"array":"generic"}var p={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=function(r,t,e,n){if(void 0===r)return(0,p.array[0])([]);"number"==typeof r&&(r=[r]),void 0===t&&(t=[r.length]);var s=t.length;if(void 0===e){e=new Array(s);for(var i=s-1,o=1;i>=0;--i)e[i]=o,o*=t[i]}if(void 0===n)for(n=0,i=0;i<s;++i)e[i]<0&&(n-=(t[i]-1)*e[i]);for(var a=u(r),c=p[a];c.length<=s+1;)c.push(h(a,c.length-1));return(0,c[s+1])(r,t,e,n)}},{"iota-array":"YG3F","is-buffer":"q/Zl"}],fDKz:[function(r,e,n){"use strict";e.exports=function(r,e){switch(void 0===e&&(e=0),t(r)){case"number":if(r>0)return function(r,t){var e,n;for(e=new Array(r),n=0;n<r;++n)e[n]=t;return e}(0|r,e);break;case"object":if("number"==typeof r.length)return function r(t,e,n){var s=0|t[n];if(s<=0)return[];var i,o=new Array(s);if(n===t.length-1)for(i=0;i<s;++i)o[i]=e;else for(i=0;i<s;++i)o[i]=r(t,e,n+1);return o}(r,e,0)}return[]}},{}],"a/V3":[function(r,t,e){"use strict";t.exports=function(r,t,e){return 0===r.length?r:t?(e||r.sort(t),function(r,t){for(var e=1,n=r.length,s=r[0],i=r[0],o=1;o<n;++o)if(i=s,t(s=r[o],i)){if(o===e){e++;continue}r[e++]=s}return r.length=e,r}(r,t)):(e||r.sort(),function(r){for(var t=1,e=r.length,n=r[0],s=r[0],i=1;i<e;++i,s=n)if(s=n,(n=r[i])!==s){if(i===t){t++;continue}r[t++]=n}return r.length=t,r}(r))}},{}],XMcq:[function(r,t,e){"use strict";var n=r("uniq");function s(r,t,e){var n,s,i=r.length,o=t.arrayArgs.length,a=t.indexArgs.length>0,h=[],u=[],p=0,c=0;for(n=0;n<i;++n)u.push(["i",n,"=0"].join(""));for(s=0;s<o;++s)for(n=0;n<i;++n)c=p,p=r[n],0===n?u.push(["d",s,"s",n,"=t",s,"p",p].join("")):u.push(["d",s,"s",n,"=(t",s,"p",p,"-s",c,"*t",s,"p",c,")"].join(""));for(u.length>0&&h.push("var "+u.join(",")),n=i-1;n>=0;--n)p=r[n],h.push(["for(i",n,"=0;i",n,"<s",p,";++i",n,"){"].join(""));for(h.push(e),n=0;n<i;++n){for(c=p,p=r[n],s=0;s<o;++s)h.push(["p",s,"+=d",s,"s",n].join(""));a&&(n>0&&h.push(["index[",c,"]-=s",c].join("")),h.push(["++index[",p,"]"].join(""))),h.push("}")}return h.join("\n")}function i(r,t,e){for(var n=r.body,s=[],i=[],o=0;o<r.args.length;++o){var a=r.args[o];if(!(a.count<=0)){var h=new RegExp(a.name,"g"),u="",p=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var c=t.offsetArgIndex.indexOf(o);p=t.offsetArgs[c].array,u="+q"+c;case"array":u="p"+p+u;var f="l"+o,l="a"+p;if(0===t.arrayBlockIndices[p])1===a.count?"generic"===e[p]?a.lvalue?(s.push(["var ",f,"=",l,".get(",u,")"].join("")),n=n.replace(h,f),i.push([l,".set(",u,",",f,")"].join(""))):n=n.replace(h,[l,".get(",u,")"].join("")):n=n.replace(h,[l,"[",u,"]"].join("")):"generic"===e[p]?(s.push(["var ",f,"=",l,".get(",u,")"].join("")),n=n.replace(h,f),a.lvalue&&i.push([l,".set(",u,",",f,")"].join(""))):(s.push(["var ",f,"=",l,"[",u,"]"].join("")),n=n.replace(h,f),a.lvalue&&i.push([l,"[",u,"]=",f].join("")));else{for(var d=[a.name],g=[u],y=0;y<Math.abs(t.arrayBlockIndices[p]);y++)d.push("\\s*\\[([^\\]]+)\\]"),g.push("$"+(y+1)+"*t"+p+"b"+y);if(h=new RegExp(d.join(""),"g"),u=g.join("+"),"generic"===e[p])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(h,[l,"[",u,"]"].join(""))}break;case"scalar":n=n.replace(h,"Y"+t.scalarArgs.indexOf(o));break;case"index":n=n.replace(h,"index");break;case"shape":n=n.replace(h,"shape")}}}return[s.join("\n"),n,i.join("\n")].join("\n").trim()}function o(r){for(var t=new Array(r.length),e=!0,n=0;n<r.length;++n){var s=r[n],i=s.match(/\d+/);i=i?i[0]:"",0===s.charAt(0)?t[n]="u"+s.charAt(1)+i:t[n]=s.charAt(0)+i,n>0&&(e=e&&t[n]===t[n-1])}return e?t[0]:t.join("")}t.exports=function(r,t){for(var e=t[1].length-Math.abs(r.arrayBlockIndices[0])|0,a=new Array(r.arrayArgs.length),h=new Array(r.arrayArgs.length),u=0;u<r.arrayArgs.length;++u)h[u]=t[2*u],a[u]=t[2*u+1];var p=[],c=[],f=[],l=[],d=[];for(u=0;u<r.arrayArgs.length;++u){r.arrayBlockIndices[u]<0?(f.push(0),l.push(e),p.push(e),c.push(e+r.arrayBlockIndices[u])):(f.push(r.arrayBlockIndices[u]),l.push(r.arrayBlockIndices[u]+e),p.push(0),c.push(r.arrayBlockIndices[u]));for(var g=[],y=0;y<a[u].length;y++)f[u]<=a[u][y]&&a[u][y]<l[u]&&g.push(a[u][y]-f[u]);d.push(g)}var v=["SS"],m=["'use strict'"],j=[];for(y=0;y<e;++y)j.push(["s",y,"=SS[",y,"]"].join(""));for(u=0;u<r.arrayArgs.length;++u){for(v.push("a"+u),v.push("t"+u),v.push("p"+u),y=0;y<e;++y)j.push(["t",u,"p",y,"=t",u,"[",f[u]+y,"]"].join(""));for(y=0;y<Math.abs(r.arrayBlockIndices[u]);++y)j.push(["t",u,"b",y,"=t",u,"[",p[u]+y,"]"].join(""))}for(u=0;u<r.scalarArgs.length;++u)v.push("Y"+u);if(r.shapeArgs.length>0&&j.push("shape=SS.slice(0)"),r.indexArgs.length>0){var b=new Array(e);for(u=0;u<e;++u)b[u]="0";j.push(["index=[",b.join(","),"]"].join(""))}for(u=0;u<r.offsetArgs.length;++u){var w=r.offsetArgs[u],A=[];for(y=0;y<w.offset.length;++y)0!==w.offset[y]&&(1===w.offset[y]?A.push(["t",w.array,"p",y].join("")):A.push([w.offset[y],"*t",w.array,"p",y].join("")));0===A.length?j.push("q"+u+"=0"):j.push(["q",u,"=",A.join("+")].join(""))}var x=n([].concat(r.pre.thisVars).concat(r.body.thisVars).concat(r.post.thisVars));for((j=j.concat(x)).length>0&&m.push("var "+j.join(",")),u=0;u<r.arrayArgs.length;++u)m.push("p"+u+"|=0");r.pre.body.length>3&&m.push(i(r.pre,r,h));var k=i(r.body,r,h),M=function(r){for(var t=0,e=r[0].length;t<e;){for(var n=1;n<r.length;++n)if(r[n][t]!==r[0][t])return t;++t}return t}(d);M<e?m.push(function(r,t,e,n){for(var i=t.length,o=e.arrayArgs.length,a=e.blockSize,h=e.indexArgs.length>0,u=[],p=0;p<o;++p)u.push(["var offset",p,"=p",p].join(""));for(p=r;p<i;++p)u.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),u.push(["if(j",p,"<",a,"){"].join("")),u.push(["s",t[p],"=j",p].join("")),u.push(["j",p,"=0"].join("")),u.push(["}else{s",t[p],"=",a].join("")),u.push(["j",p,"-=",a,"}"].join("")),h&&u.push(["index[",t[p],"]=j",p].join(""));for(p=0;p<o;++p){for(var c=["offset"+p],f=r;f<i;++f)c.push(["j",f,"*t",p,"p",t[f]].join(""));u.push(["p",p,"=(",c.join("+"),")"].join(""))}for(u.push(s(t,e,n)),p=r;p<i;++p)u.push("}");return u.join("\n")}(M,d[0],r,k)):m.push(s(d[0],r,k)),r.post.body.length>3&&m.push(i(r.post,r,h)),r.debug&&console.log("-----Generated cwise routine for ",t,":\n"+m.join("\n")+"\n----------");var I=[r.funcName||"unnamed","_cwise_loop_",a[0].join("s"),"m",M,o(h)].join("");return new Function(["function ",I,"(",v.join(","),"){",m.join("\n"),"} return ",I].join(""))()}},{uniq:"a/V3"}],PgdI:[function(r,t,e){"use strict";var n=r("./compile.js");t.exports=function(r){var t=["'use strict'","var CACHED={}"],e=[],s=r.funcName+"_cwise_thunk";t.push(["return function ",s,"(",r.shimArgs.join(","),"){"].join(""));for(var i=[],o=[],a=[["array",r.arrayArgs[0],".shape.slice(",Math.max(0,r.arrayBlockIndices[0]),r.arrayBlockIndices[0]<0?","+r.arrayBlockIndices[0]+")":")"].join("")],h=[],u=[],p=0;p<r.arrayArgs.length;++p){var c=r.arrayArgs[p];e.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),i.push("t"+c),i.push("r"+c),o.push("t"+c),o.push("r"+c+".join()"),a.push("array"+c+".data"),a.push("array"+c+".stride"),a.push("array"+c+".offset|0"),p>0&&(h.push("array"+r.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(r.arrayBlockIndices[0])-Math.abs(r.arrayBlockIndices[p]))),u.push("array"+r.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[p])+"]"))}for(r.arrayArgs.length>1&&(t.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+r.arrayArgs[0]+".shape.length-"+Math.abs(r.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),p=0;p<r.scalarArgs.length;++p)a.push("scalar"+r.scalarArgs[p]);return e.push(["type=[",o.join(","),"].join()"].join("")),e.push("proc=CACHED[type]"),t.push("var "+e.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",i.join(","),"])}","return proc(",a.join(","),")}"].join("")),r.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(n.bind(void 0,r))}},{"./compile.js":"XMcq"}],"Kt/t":[function(r,e,n){"use strict";var s=r("./lib/thunk.js");function i(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(r){var e=new i;e.pre=r.pre,e.body=r.body,e.post=r.post;var n=r.args.slice(0);e.argTypes=n;for(var o=0;o<n.length;++o){var a=n[o];if("array"===a||"object"==t(a)&&a.blockIndices){if(e.argTypes[o]="array",e.arrayArgs.push(o),e.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),e.shimArgs.push("array"+o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array args");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)e.scalarArgs.push(o),e.shimArgs.push("scalar"+o);else if("index"===a){if(e.indexArgs.push(o),o<e.pre.args.length&&e.pre.args[o].count>0)throw new Error("cwise: pre() block may not reference array index");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array index");if(o<e.post.args.length&&e.post.args[o].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(e.shapeArgs.push(o),o<e.pre.args.length&&e.pre.args[o].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(o<e.body.args.length&&e.body.args[o].lvalue)throw new Error("cwise: body() block may not write to array shape");if(o<e.post.args.length&&e.post.args[o].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=t(a)||!a.offset)throw new Error("cwise: Unknown argument type "+n[o]);e.argTypes[o]="offset",e.offsetArgs.push({array:a.array,offset:a.offset}),e.offsetArgIndex.push(o)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!r.printCode||!!r.debug,e.funcName=r.funcName||"cwise",e.blockSize=r.blockSize||64,s(e)}},{"./lib/thunk.js":"PgdI"}],AFCU:[function(r,t,e){"use strict";t.exports=function(r,t,e){if(Array.isArray(e)){if(e.length!==t.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else e=n(t.dimension,"string"==typeof e?e:"clamp");if(r.dimension!==t.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(r.shape[t.dimension]!==t.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var s=0;s<t.dimension;++s)if(r.shape[s]!==t.shape[s])throw new Error("ndarray-gradient: shape mismatch");return 0===t.size?r:t.dimension<=0?(r.set(0),r):c(e)(r,t)};var n=r("dup"),s=r("cwise-compiler"),i={},o={},a={body:"",args:[],thisVars:[],localVars:[]},h=s({args:["array","array","array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),u=s({args:["array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function p(r){if(r in i)return i[r];for(var t=[],e=0;e<r;++e)t.push("out",e,"s=0.5*(inp",e,"l-inp",e,"r);");var o=["array"],h=["junk"];for(e=0;e<r;++e){o.push("array"),h.push("out"+e+"s");var u=n(r);u[e]=-1,o.push({array:0,offset:u.slice()}),u[e]=1,o.push({array:0,offset:u.slice()}),h.push("inp"+e+"l","inp"+e+"r")}return i[r]=s({args:o,pre:a,post:a,body:{body:t.join(""),args:h.map(function(r){return{name:r,lvalue:0===r.indexOf("out"),rvalue:0===r.indexOf("inp"),count:"junk"!==r|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+r})}function c(r){var t=r.join();if(v=o[t])return v;var e=r.length,n=["function gradient(dst,src){var s=src.shape.slice();"];function s(t){for(var s=e-t.length,i=[],o=[],a=[],h=0;h<e;++h)t.indexOf(h+1)>=0?a.push("0"):t.indexOf(-(h+1))>=0?a.push("s["+h+"]-1"):(a.push("-1"),i.push("1"),o.push("s["+h+"]-2"));var u=".lo("+i.join()+").hi("+o.join()+")";if(0===i.length&&(u=""),s>0){for(n.push("if(1"),h=0;h<e;++h)t.indexOf(h+1)>=0||t.indexOf(-(h+1))>=0||n.push("&&s[",h,"]>2");for(n.push("){grad",s,"(src.pick(",a.join(),")",u),h=0;h<e;++h)t.indexOf(h+1)>=0||t.indexOf(-(h+1))>=0||n.push(",dst.pick(",a.join(),",",h,")",u);n.push(");")}for(h=0;h<t.length;++h){var p=Math.abs(t[h])-1,c="dst.pick("+a.join()+","+p+")"+u;switch(r[p]){case"clamp":var f=a.slice(),l=a.slice();t[h]<0?f[p]="s["+p+"]-2":l[p]="1",0===s?n.push("if(s[",p,"]>1){dst.set(",a.join(),",",p,",0.5*(src.get(",f.join(),")-src.get(",l.join(),")))}else{dst.set(",a.join(),",",p,",0)};"):n.push("if(s[",p,"]>1){diff(",c,",src.pick(",f.join(),")",u,",src.pick(",l.join(),")",u,");}else{zero(",c,");};");break;case"mirror":0===s?n.push("dst.set(",a.join(),",",p,",0);"):n.push("zero(",c,");");break;case"wrap":var d=a.slice(),g=a.slice();t[h]<0?(d[p]="s["+p+"]-2",g[p]="0"):(d[p]="s["+p+"]-1",g[p]="1"),0===s?n.push("if(s[",p,"]>2){dst.set(",a.join(),",",p,",0.5*(src.get(",d.join(),")-src.get(",g.join(),")))}else{dst.set(",a.join(),",",p,",0)};"):n.push("if(s[",p,"]>2){diff(",c,",src.pick(",d.join(),")",u,",src.pick(",g.join(),")",u,");}else{zero(",c,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}s>0&&n.push("};")}for(var a=0;a<1<<e;++a){for(var c=[],f=0;f<e;++f)a&1<<f&&c.push(f+1);for(var l=0;l<1<<c.length;++l){var d=c.slice();for(f=0;f<c.length;++f)l&1<<f&&(d[f]=-d[f]);s(d)}}n.push("return dst;};return gradient");var g=["diff","zero"],y=[h,u];for(a=1;a<=e;++a)g.push("grad"+a),y.push(p(a));g.push(n.join(""));var v=Function.apply(void 0,g).apply(void 0,y);return i[t]=v,v}},{dup:"fDKz","cwise-compiler":"Kt/t"}],"R/2G":[function(r,t,e){"use strict";var n=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(e,"__esModule",{value:!0});var s=n(r("./quad")),i=n(r("@talenfisher/dtype")),o=n(r("ndarray")),a=n(r("ndarray-gradient")),h=1e-4,u=5,p=.1,c=function(){function r(r){this.vertexCount=0,this.elementCount=0,this.axes=[],this.lo=[1/0,1/0,1/0],this.hi=[-1/0,-1/0,-1/0],this.missingFactor=0,this.pointBuffer=r.pointBuffer,this.origin=r.origin,this.decimationFactor=r.decimationFactor||0,this.axes=[r.axes.x,r.axes.y,r.axes.z],this.shape=[this.axes[0].size,this.axes[1].size,3],this.missingFactorUnit=1/(this.shape[0]*this.shape[1]),this.dataLength=this.shape[0]*this.shape[1]*this.shape[2],this.coords=o.default(new Float32Array(this.dataLength),this.shape),this.padStop=[0,0],this.padStart=[this.shape[0],this.shape[1]];var t=this.axes[2].dataType.name||"d",e=i.default(t);if(!e)throw new Error("Could not find data type '"+e+"'");var n=new e(this.pointBuffer),s=this.axes[0].increment/h,a=this.axes[1].increment/h,c=this.origin[1].toLowerCase(),f=this.origin[0].toLowerCase(),l="e"===c?0:this.shape[0],d="n"===f?0:this.shape[1];this.lo=[0,0,1/0],this.hi=[this.shape[0]*s,this.shape[1]*a,-1/0];for(var g=-1,y=[!1,!1],v=[!1,!1],m=Object.assign([],this.shape),j=0;j<n.length;j++){for(var b=j%this.shape[0],w=(0===b?++g:g)%this.shape[1],A=[b,w],x=0;x<2;x++)0===A[1^x]&&(y[1^x]=!1,v[x]=!1,this.padStart[x]=(this.padStart[x]+m[x])/2,m[x]=this.shape[x]);var k=Math.abs(l-b)*s,M=Math.abs(d-w)*a,I=n[j]/h*u;if(this.coords.set(b,w,0,k),this.coords.set(b,w,1,M),this.coords.set(b,w,2,I),!isNaN(n[j])&&isFinite(n[j])&&(this.lo[2]=Math.min(this.lo[2],n[j]),this.hi[2]=Math.max(this.hi[2],n[j])),isNaN(n[j])&&this.getDistanceToEdge(b,w)>p&&(this.missingFactor+=this.missingFactorUnit),!isNaN(n[j]))for(x=0;x<2;x++)y[x]||(y[x]=!0,this.padStop[x]=(this.padStop[x]+A[x])/2),m[x]=A[x]}for(j=0;j<2;j++)this.padStop[j]=Math.min(this.padStop[j],this.shape[j]*p),this.padStart[j]=Math.max(this.padStart[j],this.shape[j]*(1-p));var _=0;for(j=0;j<2;j++){var F=1^j;_+=this.missingFactorUnit*this.shape[F]*this.padStop[j],_+=this.missingFactorUnit*this.shape[F]*(this.shape[j]-this.padStart[j])}console.log("padding: "+_),console.log("missing: "+this.missingFactor),console.log("size: "+this.shape),this.missingFactor=Math.max(this.missingFactor-_,0),this.buffer()}return r.prototype.setupGradient=function(){var r=[3,this.shape[0],this.shape[1],2],t=this.coords;this.gradient=o.default(new Float32Array(2*this.dataLength),r);for(var e=0;e<3;e++)a.default(this.gradient.pick(e),t.pick(null,null,e))},r.prototype.getDistanceToEdge=function(r,t){var e=Math.ceil(this.shape[0]/2),n=Math.ceil(this.shape[1]/2),s=Math.abs(r-e)/this.shape[0],i=Math.abs(t-n)/this.shape[1];return Math.min(s,i)},r.prototype.getNormal=function(r,t){if(this.gradient){var e=this.gradient.get(0,r,t,0),n=this.gradient.get(0,r,t,1),s=this.gradient.get(1,r,t,0),i=this.gradient.get(1,r,t,1),o=this.gradient.get(2,r,t,0),a=this.gradient.get(2,r,t,1),h=s*a-i*o,u=o*n-a*e,p=e*i-n*s,c=Math.sqrt(Math.pow(h,2)+Math.pow(u,2)+Math.pow(p,2));return c<1e-8?(c=Math.max(Math.abs(h),Math.abs(u),Math.abs(p)))<1e-8?(p=1,u=h=0,c=1):c=1/c:c=1/Math.sqrt(c),[h*c,u*c,p*c]}},r.prototype.buffer=function(){var r=this.stride,t=this.coords,e=s.default(r),n=0,i=this.shape[0]-r,o=this.shape[1]-r,a=e.length,h=i*o*a*8;this.setupGradient(),this.elementCount=0,this.vertexCount=0,this.coordBuffer=new Float32Array(h);for(var u=0;u<i;u+=r){r:for(var p=0;p<o;p+=r){for(var c=0;c<=r;c++)for(var f=0;f<=r;f++){var l=t.get(1+u+c,1+p+f,2);if(isNaN(l)||!isFinite(l))continue r}for(var d=u/this.shape[0],g=p/this.shape[1],y=0;y<a;y++){var v=u+e[y][0],m=p+e[y][1];this.coordBuffer[n++]=t.get(v,m,0),this.coordBuffer[n++]=t.get(v,m,1),this.coordBuffer[n++]=t.get(v,m,2);var j=this.getNormal(v,m);this.coordBuffer[n++]=j[0],this.coordBuffer[n++]=j[1],this.coordBuffer[n++]=j[2],this.coordBuffer[n++]=d,this.coordBuffer[n++]=g,this.vertexCount++}}postMessage({progress:u/this.shape[0]})}this.elementCount=n},Object.defineProperty(r.prototype,"result",{get:function(){var r=this.coords;return{vertexCount:this.vertexCount,elementCount:this.elementCount,buffer:this.coordBuffer,shape:[r.shape[0],r.shape[1]],bounds:[this.lo,this.hi],missingFactor:this.missingFactor}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stride",{get:function(){var r=this.decimationFactor;r=Math.max(0,r),r=Math.min(r,1);var t=this.coords.shape,e=(t[0]+t[1])/2,n=Math.floor(e/200);return 1+Math.floor(r*n)},enumerable:!0,configurable:!0}),r}();onmessage=function(r){var t=new c(r.data).result,e=Object.assign({progress:1},t),n=[t.buffer.buffer];postMessage(e,n),close()}},{"./quad":"gm1b","@talenfisher/dtype":"oQJj",ndarray:"cMKA","ndarray-gradient":"AFCU"}]},{},["R/2G"]);
},{}]},{},["Ofed"], null)